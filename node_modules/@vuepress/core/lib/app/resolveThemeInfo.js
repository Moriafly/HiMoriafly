"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveThemeInfo = void 0;
const resolvePluginsFromConfig_1 = require("./resolvePluginsFromConfig");
const resolveThemeLayouts_1 = require("./resolveThemeLayouts");
const resolveThemeObject_1 = require("./resolveThemeObject");
/**
 * Resolve theme info and its parent theme info
 */
const resolveThemeInfo = (app, theme, themeConfig) => {
    var _a, _b;
    // resolve current theme info
    const themeObject = (0, resolveThemeObject_1.resolveThemeObject)(app, theme, themeConfig);
    const themeInfo = {
        layouts: (0, resolveThemeLayouts_1.resolveThemeLayouts)(themeObject.layouts),
        plugins: [
            ...(0, resolvePluginsFromConfig_1.resolvePluginsFromConfig)(app, themeObject.plugins),
            themeObject,
        ],
        templateBuild: themeObject.templateBuild,
        templateDev: themeObject.templateDev,
    };
    // return if current theme does not have a parent theme
    if (!themeObject.extends) {
        return themeInfo;
    }
    // resolve parent theme info recursively
    const parentThemeInfo = (0, exports.resolveThemeInfo)(app, themeObject.extends, themeConfig);
    return {
        layouts: { ...parentThemeInfo.layouts, ...themeInfo.layouts },
        plugins: [...parentThemeInfo.plugins, ...themeInfo.plugins],
        templateBuild: (_a = themeObject.templateBuild) !== null && _a !== void 0 ? _a : parentThemeInfo.templateBuild,
        templateDev: (_b = themeObject.templateDev) !== null && _b !== void 0 ? _b : parentThemeInfo.templateDev,
    };
};
exports.resolveThemeInfo = resolveThemeInfo;
