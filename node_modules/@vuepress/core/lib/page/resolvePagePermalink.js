"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolvePagePermalink = void 0;
const shared_1 = require("@vuepress/shared");
const utils_1 = require("@vuepress/utils");
/**
 * Resolve page permalink from frontmatter / options / pattern
 */
const resolvePagePermalink = ({ frontmatter, slug, date, pathInferred, pathLocale, }) => {
    var _a;
    // use permalink in frontmatter directly
    if ((0, shared_1.isString)(frontmatter.permalink)) {
        return frontmatter.permalink;
    }
    // get permalink pattern from frontmatter or options
    const pattern = (0, shared_1.isString)(frontmatter.permalinkPattern)
        ? frontmatter.permalinkPattern
        : null;
    if (!pattern) {
        return null;
    }
    // resolve permalink according to the pattern
    const [year, month, day] = date.split('-');
    const link = utils_1.path.join(pathLocale, pattern
        .replace(/:year/, year)
        .replace(/:month/, month)
        .replace(/:day/, day)
        .replace(/:slug/, slug)
        .replace(/:raw/, (_a = pathInferred === null || pathInferred === void 0 ? void 0 : pathInferred.replace(/^\//, '')) !== null && _a !== void 0 ? _a : ''));
    return (0, shared_1.ensureLeadingSlash)(link);
};
exports.resolvePagePermalink = resolvePagePermalink;
