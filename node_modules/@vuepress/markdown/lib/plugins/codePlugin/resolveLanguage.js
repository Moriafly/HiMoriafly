"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveLanguage = void 0;
const languages = require("./languages");
/**
 * A key-value map to get language info from alias
 *
 * - key: alias
 * - value: language
 */
let languagesMap;
/**
 * Lazy generate languages map
 */
const getLanguagesMap = () => {
    if (!languagesMap) {
        languagesMap = Object.values(languages).reduce((result, item) => {
            item.aliases.forEach((alias) => {
                result[alias] = item;
            });
            return result;
        }, {});
    }
    return languagesMap;
};
/**
 * Resolve language for highlight from token info
 */
const resolveLanguage = (info) => {
    var _a, _b;
    // get user-defined language alias
    const alias = ((_a = info.match(/^([a-zA-Z]+)/)) === null || _a === void 0 ? void 0 : _a[1]) || 'text';
    // if the alias does not have a match in the map
    // fallback to the alias itself
    return ((_b = getLanguagesMap()[alias]) !== null && _b !== void 0 ? _b : {
        name: alias,
        ext: alias,
        aliases: [alias],
    });
};
exports.resolveLanguage = resolveLanguage;
