"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.appPrepare = void 0;
const utils_1 = require("@vuepress/utils");
const prepare_1 = require("./prepare");
const log = (0, utils_1.debug)('vuepress:core/app');
/**
 * Prepare files for development or build
 *
 * - page components
 * - routes
 * - site data
 * - other files that generated by plugins
 */
const appPrepare = async (app) => {
    log('prepare start');
    // generate page component files
    for (const page of app.pages) {
        await (0, prepare_1.preparePageComponent)(app, page);
    }
    await (0, prepare_1.preparePagesComponents)(app);
    // generate page data files
    for (const page of app.pages) {
        await (0, prepare_1.preparePageData)(app, page);
    }
    await (0, prepare_1.preparePagesData)(app);
    // generate routes file
    await (0, prepare_1.preparePagesRoutes)(app);
    // generate layout components map file
    await (0, prepare_1.prepareLayoutComponents)(app);
    // generate site data file
    await (0, prepare_1.prepareSiteData)(app);
    // generate client app enhances file
    await (0, prepare_1.prepareClientAppEnhances)(app);
    // generate client app root components file
    await (0, prepare_1.prepareClientAppRootComponents)(app);
    // generate client app setups file
    await (0, prepare_1.prepareClientAppSetups)(app);
    // plugin hook: onPrepared
    await app.pluginApi.hooks.onPrepared.process(app);
    log('prepare finish');
};
exports.appPrepare = appPrepare;
