"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.resolveClientManifestMeta = void 0;
const resolveFileMeta_1 = require("./resolveFileMeta");
/**
 * Resolve files meta from clientManifest
 */
const resolveClientManifestMeta = ({ all, initial, async, modules, }) => {
    // all files meta
    const allFilesMeta = all.map(resolveFileMeta_1.resolveFileMeta);
    // initial files meta
    const initialFilesMeta = initial.map(resolveFileMeta_1.resolveFileMeta);
    // async files meta
    const asyncFilesMeta = async.map(resolveFileMeta_1.resolveFileMeta);
    // module to files meta map
    const moduleFilesMetaMap = Object.fromEntries(Object.entries(modules).map(([moduleRequest, assetFilesIndex]) => {
        return [
            moduleRequest,
            assetFilesIndex
                .map((fileIndex) => allFilesMeta[fileIndex])
                .filter(({ file, type }) => async.includes(file) || (type !== 'style' && type !== 'script')),
        ];
    }));
    return {
        allFilesMeta,
        initialFilesMeta,
        asyncFilesMeta,
        moduleFilesMetaMap,
    };
};
exports.resolveClientManifestMeta = resolveClientManifestMeta;
