---
sidebar_position: 3
---

# 扫描歌曲

基于椒盐音乐 8.2.0 （测试）版本，部分功能属于测试阶段，下面部分可能存在表述问题。

## 椒盐音乐 V7 等版本的问题

歌曲来源基于 Android 媒体库会存在以下问题：

- 支持扫描的格式依赖本机（与设备相关），扫描需要系统支持，存在较多的设备不支持扫描 DSD / APE 格式歌曲
- 歌曲的更新需要 Android 媒体库重新扫描，如系统文件管理器移动歌曲等会调用 Android 媒体库对指定路径扫描，但存在有些管理器不进行刷新造成 Android 媒体库不能及时感知刷新
- 外部 TF 卡等移除装载可能存在上个问题，也存在完全的路径不同而需要在此手动扫描
- 专辑艺术家分类依赖 Android 媒体库，使得椒盐音乐 V7 版本虽然兼容了 WAV 格式的内嵌数据，但是不支持艺术家、专辑分类
- Android 媒体库自 Android 10 开始支持专辑艺术家标签读取，椒盐音乐 V7 专辑艺术家显示不准
- 部分系统存在乱码问题（椒盐音乐 V7 仅解决部分）

## 椒盐音乐 V8.2 扫描逻辑

为了实现 `自定义文件夹扫描` 的同时兼容原有的数据，椒盐音乐 V8 同时实现了 Android 媒体库 + 自定义文件夹 扫描（二者是几乎独立的）。

所以可以仅 `使用 Android 媒体库` 或仅使用 `自定义文件夹` 或同时使用二者，下面将对此三种情况的扫描进行说明：

### 仅使用 Android 媒体库

逻辑和 V7 版本几乎一致，如果你使用 V7 的时候没什么问题，那么可以选择它。艺术家、专辑的问题也已经解决，只是若你的设备不支持 DSD / APE 格式扫描，那么它依旧扫描不到。

同时注意，V7 的屏蔽音频、屏蔽文件夹将失效，下面两种方式也一样。

屏蔽 60 秒以下歌曲功能也被移除，而默认屏蔽小于 1 MB 的音频（下同）。

### 仅使用自定义文件夹

支持的文件拓展名为 MP3 AAC FLAC WAV OPUS WV DSF DFF APE OGG M4A ALAC （仅使用 Android 媒体库方式也被限制在这些格式中，仅允许子集）。

支持扫描 DSF DFF 格式，但是这两者的元数据读取依旧依赖系统，即如果你的 Android 媒体库不支持此格式，那么虽然可以扫描到它但元数据读取暂时是不正常的，等待后续更新。

APE 格式元数据支持，但是封面读取依赖系统。

### 同时使用 Android 媒体库和自定义文件夹

将优先使用 Android 媒体库扫描在进行一次自定义文件夹扫描，所以最终扫描到的歌曲是这两者扫描的并集。